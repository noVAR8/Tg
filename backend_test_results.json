[
  {
    "test": "Basic API",
    "status": "PASS",
    "message": "Server is running",
    "timestamp": "2025-07-12T11:13:27.106878",
    "details": {
      "message": "Telegram Bot API Server with Referral System",
      "status": "running"
    }
  },
  {
    "test": "Usersbox Integration",
    "status": "PASS",
    "message": "API token works, balance: 10, active: True",
    "timestamp": "2025-07-12T11:13:27.930639",
    "details": {
      "id": 1752317970,
      "title": "Slit",
      "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjcmVhdGVkX2F0IjoxNzUyMzE3OTcwLCJhcHBfaWQiOjE3NTIzMTc5NzB9.yQb2nFHs7B-UZ-UvxhyQty7Zuu9QjZ5yWH-s-LEgd90",
      "created_at": "2025-07-12T13:59:29.836Z",
      "is_active": true,
      "balance": 10,
      "owner": {
        "user_id": 1557902375,
        "bot_id": 7952592619
      }
    }
  },
  {
    "test": "Webhook Setup",
    "status": "PASS",
    "message": "Webhook set successfully to https://3312ad11-8248-4d7e-86f5-1571a6d10e5d.preview.emergentagent.com/api/webhook",
    "timestamp": "2025-07-12T11:13:28.296232",
    "details": {
      "ok": true,
      "result": true,
      "description": "Webhook is already set"
    }
  },
  {
    "test": "Enhanced Stats Endpoint",
    "status": "PASS",
    "message": "Database connected, 23 messages, 0 searches, 0 users, 0 referrals",
    "timestamp": "2025-07-12T11:13:28.314330",
    "details": {
      "total_messages": 23,
      "total_searches": 0,
      "total_users": 0,
      "total_referrals": 0,
      "recent_messages": [
        {
          "id": "71d7e28c-54cf-4431-9c70-fd296edac99e",
          "chat_id": 987654321,
          "text": "/search",
          "direction": "incoming",
          "timestamp": "2025-07-12T11:00:51.730000",
          "update_data": {
            "update_id": 123456792,
            "message": {
              "message_id": 4,
              "from": {
                "id": 987654321,
                "is_bot": false,
                "first_name": "Test",
                "username": "testuser"
              },
              "chat": {
                "id": 987654321,
                "first_name": "Test",
                "username": "testuser",
                "type": "private"
              },
              "date": 1640995200,
              "text": "/search"
            }
          }
        },
        {
          "id": "387b9020-944e-43aa-8fd5-43ca68df0013",
          "chat_id": 987654321,
          "text": "+7 929 847-04-21",
          "direction": "incoming",
          "timestamp": "2025-07-12T11:00:51.385000",
          "update_data": {
            "update_id": 123456791,
            "message": {
              "message_id": 3,
              "from": {
                "id": 987654321,
                "is_bot": false,
                "first_name": "Test",
                "username": "testuser"
              },
              "chat": {
                "id": 987654321,
                "first_name": "Test",
                "username": "testuser",
                "type": "private"
              },
              "date": 1640995200,
              "text": "+7 929 847-04-21"
            }
          }
        },
        {
          "id": "ae47ef8d-e628-41ae-bcd1-c8d31608597d",
          "chat_id": 987654321,
          "text": "/search +7(929)847-04-21",
          "direction": "incoming",
          "timestamp": "2025-07-12T11:00:50.601000",
          "update_data": {
            "update_id": 123456790,
            "message": {
              "message_id": 2,
              "from": {
                "id": 987654321,
                "is_bot": false,
                "first_name": "Test",
                "username": "testuser"
              },
              "chat": {
                "id": 987654321,
                "first_name": "Test",
                "username": "testuser",
                "type": "private"
              },
              "date": 1640995200,
              "text": "/search +7(929)847-04-21"
            }
          }
        },
        {
          "id": "b731bca1-57e5-4d21-9609-d108585c9e29",
          "chat_id": 987654321,
          "text": "/search 9298470421",
          "direction": "incoming",
          "timestamp": "2025-07-12T11:00:49.670000",
          "update_data": {
            "update_id": 123456790,
            "message": {
              "message_id": 2,
              "from": {
                "id": 987654321,
                "is_bot": false,
                "first_name": "Test",
                "username": "testuser"
              },
              "chat": {
                "id": 987654321,
                "first_name": "Test",
                "username": "testuser",
                "type": "private"
              },
              "date": 1640995200,
              "text": "/search 9298470421"
            }
          }
        },
        {
          "id": "6bda7171-9fa5-4f4a-bb97-7fdb5556b1f5",
          "chat_id": 987654321,
          "text": "/search 79298470421",
          "direction": "incoming",
          "timestamp": "2025-07-12T11:00:48.540000",
          "update_data": {
            "update_id": 123456790,
            "message": {
              "message_id": 2,
              "from": {
                "id": 987654321,
                "is_bot": false,
                "first_name": "Test",
                "username": "testuser"
              },
              "chat": {
                "id": 987654321,
                "first_name": "Test",
                "username": "testuser",
                "type": "private"
              },
              "date": 1640995200,
              "text": "/search 79298470421"
            }
          }
        },
        {
          "id": "02de4dd3-8901-4f71-ab0b-28f5fac688b2",
          "chat_id": 987654321,
          "text": "/search 8-929-847-04-21",
          "direction": "incoming",
          "timestamp": "2025-07-12T11:00:47.482000",
          "update_data": {
            "update_id": 123456790,
            "message": {
              "message_id": 2,
              "from": {
                "id": 987654321,
                "is_bot": false,
                "first_name": "Test",
                "username": "testuser"
              },
              "chat": {
                "id": 987654321,
                "first_name": "Test",
                "username": "testuser",
                "type": "private"
              },
              "date": 1640995200,
              "text": "/search 8-929-847-04-21"
            }
          }
        },
        {
          "id": "6fee93e2-8bc1-4451-9e2e-0858b1bfa29d",
          "chat_id": 987654321,
          "text": "/search +7 929 847-04-21",
          "direction": "incoming",
          "timestamp": "2025-07-12T11:00:46.494000",
          "update_data": {
            "update_id": 123456790,
            "message": {
              "message_id": 2,
              "from": {
                "id": 987654321,
                "is_bot": false,
                "first_name": "Test",
                "username": "testuser"
              },
              "chat": {
                "id": 987654321,
                "first_name": "Test",
                "username": "testuser",
                "type": "private"
              },
              "date": 1640995200,
              "text": "/search +7 929 847-04-21"
            }
          }
        },
        {
          "id": "66ce5ba9-50e1-466a-bdc8-26c433e56b8c",
          "chat_id": 987654321,
          "text": "/start",
          "direction": "incoming",
          "timestamp": "2025-07-12T11:00:46.194000",
          "update_data": {
            "update_id": 123456789,
            "message": {
              "message_id": 1,
              "from": {
                "id": 987654321,
                "is_bot": false,
                "first_name": "Test",
                "username": "testuser"
              },
              "chat": {
                "id": 987654321,
                "first_name": "Test",
                "username": "testuser",
                "type": "private"
              },
              "date": 1640995200,
              "text": "/start"
            }
          }
        },
        {
          "id": "f108acfa-1166-4c20-bc80-529402ea3111",
          "chat_id": 1557902375,
          "text": "\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0438\u0441\u043a\u0435: ",
          "direction": "outgoing",
          "timestamp": "2025-07-12T10:58:37.374000",
          "status": "sent"
        },
        {
          "id": "c94f203d-0866-4843-928a-2ac2ea87291a",
          "chat_id": 1557902375,
          "text": "\ud83d\udd0d \u0418\u0449\u0443 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043f\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u0443: `+79002931599`",
          "direction": "outgoing",
          "timestamp": "2025-07-12T10:58:31.717000",
          "status": "sent"
        }
      ],
      "recent_searches": [],
      "top_users": []
    }
  },
  {
    "test": "Users API Endpoint",
    "status": "PASS",
    "message": "Retrieved 0 user profiles",
    "timestamp": "2025-07-12T11:13:28.364120",
    "details": {
      "user_count": 0,
      "sample_user": null
    }
  },
  {
    "test": "Referrals API Endpoint",
    "status": "PASS",
    "message": "Retrieved 0 referral records",
    "timestamp": "2025-07-12T11:13:28.385744",
    "details": {
      "referral_count": 0,
      "sample_referral": null
    }
  },
  {
    "test": "User Profile Creation",
    "status": "FAIL",
    "message": "Webhook returned error status",
    "timestamp": "2025-07-12T11:13:28.633034",
    "details": {
      "status": "error",
      "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
    }
  },
  {
    "test": "Profile Command",
    "status": "FAIL",
    "message": "Webhook returned error status",
    "timestamp": "2025-07-12T11:13:28.925408",
    "details": {
      "status": "error",
      "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
    }
  },
  {
    "test": "Referral Command",
    "status": "FAIL",
    "message": "Webhook returned error status",
    "timestamp": "2025-07-12T11:13:29.325580",
    "details": {
      "status": "error",
      "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
    }
  },
  {
    "test": "Referral System",
    "status": "FAIL",
    "message": "Invite command returned error",
    "timestamp": "2025-07-12T11:13:29.891162",
    "details": {
      "status": "error",
      "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
    }
  },
  {
    "test": "Attempt System",
    "status": "FAIL",
    "message": "Search command returned error",
    "timestamp": "2025-07-12T11:13:30.289913",
    "details": {
      "status": "error",
      "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
    }
  },
  {
    "test": "Webhook Endpoint",
    "status": "FAIL",
    "message": "Webhook returned error status",
    "timestamp": "2025-07-12T11:13:30.443242",
    "details": {
      "status": "error",
      "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
    }
  },
  {
    "test": "Phone Number Formatting",
    "status": "FAIL",
    "message": "Some phone formats failed processing",
    "timestamp": "2025-07-12T11:13:35.476118",
    "details": [
      {
        "input": "+7 929 847-04-21",
        "description": "International format with spaces and dashes",
        "status": "failed",
        "error": {
          "status": "error",
          "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
        }
      },
      {
        "input": "8-929-847-04-21",
        "description": "Russian format starting with 8",
        "status": "failed",
        "error": {
          "status": "error",
          "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
        }
      },
      {
        "input": "79298470421",
        "description": "Russian format without +",
        "status": "failed",
        "error": {
          "status": "error",
          "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
        }
      },
      {
        "input": "9298470421",
        "description": "Mobile format without country code",
        "status": "failed",
        "error": {
          "status": "error",
          "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
        }
      },
      {
        "input": "+7(929)847-04-21",
        "description": "Format with parentheses",
        "status": "failed",
        "error": {
          "status": "error",
          "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
        }
      }
    ]
  },
  {
    "test": "Usersbox Query Formatting",
    "status": "FAIL",
    "message": "Webhook returned error status",
    "timestamp": "2025-07-12T11:13:35.924636",
    "details": {
      "status": "error",
      "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
    }
  },
  {
    "test": "Error Handling",
    "status": "FAIL",
    "message": "Webhook returned error for empty query",
    "timestamp": "2025-07-12T11:13:36.148853",
    "details": {
      "status": "error",
      "message": "Client error '400 Bad Request' for url 'https://api.telegram.org/bot6467050584:AAHhM8xo_VT-Ublz3A_2u3pU34k525b2lNg/sendMessage'\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400"
    }
  }
]